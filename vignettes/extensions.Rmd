---
title: "Extensions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Extensions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The basic power analysis as described in the Vignette [Getting started](https://jeroendmulder.github.io/powRICLPM/articles/start.html) can be extended to using bounded estimation, estimation with constraints over time, and the inclusion of measurement error variances. These extensions are described below.

## Bounded estimation with `lavaan`
To prevent non-convergence for small sample sizes (say, less than 100), bounds can be imposed on the parameter space during estimation of the model using `bounds = TRUE` [(De Jonckere & Rosseel, 2022)](https://doi.org/10.1080/10705511.2021.1982716). This can aid the optimization algorithm to find unique solutions and prevents it from searching in the completely wrong direction for one, or multiple parameters. Sensible lower bounds involve those on the (residual) variances of latent variables (e.g., the random intercept variances), as negative variances are theoretically not possible. Upper bound for variances are determined based on the observed variances for variable. In the context of the RI-CLPM, the factor loadings are (usually) fixed, and hence these parameters are not estimated. The lagged effects are theoretically infinite, and hence there are no sensible bounds we can place Ã  priori on these parameters. 

## Constraints over time
`powRICLPM` offers users the option to impose various constraints over time on the estimation model through the `constraints` argument. This has statistical advantages as constraints over time reduce model complexity, thereby potentially reducing convergence issues and increasing power. Moreover, some researchers are interested in so called 'stationarity' constraints for theoretical reasons. Disadvantages of such constraints are that they assume certain parameters over time do not change. This might not be an assumption researchers are willing to make, especially in developmental contexts where you expect lagged effects might change over time (e.g., the variable `wA` gets more important in driving `wB` as one gets older). Therefore, by default `constraints = "none"`, implying that all lagged effects, and within-components (residual) variances and covariances are freely estimated over time. 

Constraint options include:

- `constraints = "lagged"`: All autoregressive and cross-lagged effects are constrained to be equal over time. 
- `constraints = "residuals`: The within-unit residual variances and covariance (from wave 2 onward) are constrained to be equal over time.
- `constraints = "within"`: Both lagged effects and residual variances and covariances are constrained to be equal over time.
- `constraints = "stationary"`: Constraints are imposed on the variances of the within-components at the first wave, and residual variances at wave 2 and further, such that the variances of the within-components themselves are all 1. This implies that the variances at the first wave are fixed to 1, and that the residual variances are a function of the lagged effects, and correlation between within-components at the same wave. These constraints are deduced in the supplementary materials of [Mulder and Hamaker (see the FAQ "How can I constrain the *standardized* parameters to be invariant over time?")](https://jeroendmulder.github.io/RI-CLPM/faq.html#Standardization).
- `constraints = "ME"`: Constraints are imposed on the measurement error variances across time. This constraint is only possible when `est_ME = TRUE`. 

## Measurement error
While it is generally advisable to include measurement error when analyzing psychological data, the RI-CLPM does not include it. Adding measurement error to the model would result in the bivariate Trait State Error (TSE) model by [Kenny and Zautra (1995)](https://doi.org/10.1037/10409-008), and requires at least 4 waves of data to be identified. Users can add measurement error variances to the estimation model by setting the `est_ME` argument to `est_ME = TRUE`. Measurement error can be added to the simulated data using the `reliability` argument.

Note, however, that this model (the bivariate TSE) has been shown to be prone to empirical under-identification, often requiring upwards of 8 waves of data and sample sizes larger than 500. 

