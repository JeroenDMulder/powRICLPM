<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="powRICLPM">
<title>Extensions • powRICLPM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extensions">
<meta property="og:description" content="powRICLPM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">powRICLPM</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/start.html">Getting started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/start.html">Getting started</a>
    <a class="dropdown-item" href="../articles/extensions.html">Extensions</a>
    <a class="dropdown-item" href="../articles/mplus.html">Using Mplus</a>
    <a class="dropdown-item" href="../articles/Mulder2022.html">Example</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/FAQ.html">FAQ</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JeroenDMulder/powRICLPM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extensions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JeroenDMulder/powRICLPM/blob/HEAD/vignettes/extensions.Rmd" class="external-link"><code>vignettes/extensions.Rmd</code></a></small>
      <div class="d-none name"><code>extensions.Rmd</code></div>
    </div>

    
    
<p>The basic power analysis as described in the Vignette <a href="https://jeroendmulder.github.io/powRICLPM/articles/getting-started.html" class="external-link">Getting started</a> can be extended to using bounded estimation, and estimation with constraints over time. These extensions are described below.</p>
<div class="section level2">
<h2 id="bounded-estimation-with-lavaan">Bounded estimation with <code>lavaan</code><a class="anchor" aria-label="anchor" href="#bounded-estimation-with-lavaan"></a>
</h2>
<p>To prevent non-convergence for small sample sizes (say, less than 100), bounds can be imposed on the parameter space during estimation of the model <a href="https://doi.org/10.1080/10705511.2021.1982716" class="external-link">(De Jonckere &amp; Rosseel, 2022)</a>. This can aid the optimization algorithm to find unique solutions and prevents it from searching in the completely wrong direction for one, or multiple parameters. Sensible lower bounds involve those on the (residual) variances of latent variables (e.g., the random intercept variances), as negative variances are theoretically not possible. Upper bound for variances are determined based on the observed variances for variable. In the context of the RI-CLPM, the factor loadings are (usually) fixed, and hence these parameters are not estimated. The lagged effects are theoretically infinite, and hence there are no sensible bounds we can place à priori on these parameters.</p>
<p>Below I demonstrate the use of bounds for the RI-CLPM independently from the <code>powRICLPM</code> package first. I start with the generation of a small dataset (<span class="math inline">\(n = 30\)</span>) that leads to non-convergence when estimated. Next, I impose the automatic wide bounds as recommended by <a href="https://doi.org/10.1080/10705511.2021.1982716" class="external-link">(De Jonckere &amp; Rosseel, 2022)</a> and test the convergence again.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Population parameter values</span>
<span class="va">Phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> 
<span class="va">wSigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.3</span>, <span class="fl">.3</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">ICC</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">RI_cor</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>

<span class="co"># Compute other population parameter values</span>
<span class="va">RI_var</span> <span class="op">&lt;-</span> <span class="fu">powRICLPM</span><span class="fu">::</span><span class="fu">compute_RI_var</span><span class="op">(</span>ICC <span class="op">=</span> <span class="va">ICC</span><span class="op">)</span>
<span class="va">RI_cov</span> <span class="op">&lt;-</span> <span class="fu">powRICLPM</span><span class="fu">::</span><span class="fu">compute_RI_cov</span><span class="op">(</span>RI_cor <span class="op">=</span> <span class="va">RI_cor</span>, RI_var <span class="op">=</span> <span class="va">RI_var</span><span class="op">)</span>
<span class="va">Psi</span> <span class="op">&lt;-</span> <span class="fu">powRICLPM</span><span class="fu">::</span><span class="fu">compute_Psi</span><span class="op">(</span><span class="va">Phi</span>, <span class="va">wSigma</span><span class="op">)</span>

<span class="co"># Get lavaan model syntax</span>
<span class="va">model_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_lavaan.html">create_lavaan</a></span><span class="op">(</span>time_points <span class="op">=</span> <span class="fl">3</span>,
                           RI_var <span class="op">=</span> <span class="va">RI_var</span>,
                           RI_cov <span class="op">=</span> <span class="va">RI_cov</span>,
                           Phi <span class="op">=</span> <span class="va">Phi</span>,
                           wSigma <span class="op">=</span> <span class="va">wSigma</span>,
                           Psi <span class="op">=</span> <span class="va">Psi</span>,
                           syntax <span class="op">=</span> <span class="cn">TRUE</span>,
                           estimation <span class="op">=</span> <span class="cn">TRUE</span>, 
                           constraints <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>

<span class="va">model_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_lavaan.html">create_lavaan</a></span><span class="op">(</span>time_points <span class="op">=</span> <span class="fl">3</span>,
                            RI_var <span class="op">=</span> <span class="va">RI_var</span>,
                            RI_cov <span class="op">=</span> <span class="va">RI_cov</span>,
                            Phi <span class="op">=</span> <span class="va">Phi</span>,
                            wSigma <span class="op">=</span> <span class="va">wSigma</span>,
                            Psi <span class="op">=</span> <span class="va">Psi</span>,
                            syntax <span class="op">=</span> <span class="cn">TRUE</span>,
                            estimation <span class="op">=</span> <span class="cn">FALSE</span>,
                            constraints <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>

<span class="co"># Generate data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> 
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html" class="external-link">simulateData</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_data</span>, sample.nobs <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>

<span class="co"># Estimate model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_est</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> 
<span class="fu">inspect</span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"converged"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># (co)variances of random intercepts completely out of bounds</span>

<span class="co"># Estimate model with wide automatic bounds</span>
<span class="va">fit_bounds_wide</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_est</span>,
                                  data <span class="op">=</span> <span class="va">df</span>,
                                  optim.bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lv.var"</span><span class="op">)</span>,
                                                      upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lv.var"</span><span class="op">)</span>,
                                                      lower.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.05</span><span class="op">)</span>,
                                                      upper.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavParTable.html" class="external-link">parTable</a></span><span class="op">(</span><span class="va">fit_bounds_wide</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lhs"</span>, <span class="st">"op"</span>, <span class="st">"rhs"</span>, <span class="st">"free"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>, <span class="st">"est"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>These results show that with this small sample size, and without bounds imposed during estimation, <code>lavaan</code> fails to find a solution. Upon inspection of the coefficients, we find that the large negative variances of the random intercept factors are causing the problems. However, once the automatic wide bounds are imposed, <code>lavaan</code> does converge on the same small data set. Still, the random intercept variances are negative showing that there is too little information in the data to reliable estimate the random intercept variances.</p>
<p>In the context of <code>powRICLPM</code>, it can be useful to impose bounds on the estimation model when simulating the power on small sample sizes. It aids in the prevention of non-convergence, and speeds up the analysis as well. Bounded estimation can be easily done by stating <code>bounds = TRUE</code> as an argument in the <code><a href="../reference/powRICLPM.html">powRICLPM()</a></code> function.</p>
</div>
<div class="section level2">
<h2 id="constraints-over-time">Constraints over time<a class="anchor" aria-label="anchor" href="#constraints-over-time"></a>
</h2>
<p><code>powRICLPM</code> offers users the option to impose various constraints over time on the estimation model through the <code>constraints</code> argument. This has statistical advantages as constraints over time reduce model complexity, thereby potentially reducing convergence issues and increasing power. Moreover, some researchers are interested in so called ‘stationarity’ constraints for theoretical reasons. Disadvantages of such constraints are that they assume certain parameters over time do not change. This might not be an assumption researchers are willing to make, especially in developmental contexts where you expect lagged effects might change over time (e.g., the variable <code>wA</code> gets more important in driving <code>wB</code> as one gets older). Therefore, by default <code>constraints = "none"</code>, implying that all lagged effects, and within-components (residual) variances and covariances are freely estimated over time.</p>
<p>You have the option to specify:</p>
<ul>
<li>
<code>constraints = "lagged"</code>: All autoregressive and cross-lagged effects are constrained to be equal over time.</li>
<li>
<code>constraints = "residuals</code>: The within-unit residual variances and covariance (from wave 2 onwards) are constrained to be equal over time.</li>
<li>
<code>constraints = "within"</code>: Both lagged effects and residual variances and covariances are constrained to be equal over time.</li>
<li>
<code>constraints = "stationary"</code>: Constraints are imposed on the variances of the within-components at the first wave, and residual variances at wave 2 and further, such that the variances of the within-components themselves are all 1. This implies that the variances at the first wave are fixed to 1, and that the residual variances are a function of the lagged effects, and correlation between within-components at the same wave. These constraints are deduced in Mulder (under review).</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeroen Mulder.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
